---
title: "Cox Proportional Hazard Models"
subtitle: "Survival Analysis"
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    lib_dir: libs
    nature:
      highlightStyle: github
      countIncrementalSlides: false
---

```{r eval=FALSE,include=FALSE}

# CT6 
# - ASI 2005 April Question B - 1
# - ASI 2006 April Question B - 1

```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(magrittr)
library(knitr)
library(dplyr)
library(janitor)


```

```{r xaringan-themer, include=FALSE, warning=FALSE}
library(xaringanthemer)
style_mono_accent_inverse(
  base_color = "#3C989E", #)(
#  base_color = "#1c5253",
  header_font_google = google_font("Josefin Sans"),
  text_font_google   = google_font("Montserrat", "300", "300i"),
  code_font_google   = google_font("Fira Mono")
)
```

#### Exercises 

1. Write down the equation of the **Cox proportional hazards model** in which the hazard function depends on duration $t$ and a vector of covariates $z$. 
You should define all the other terms that you use.

2. Explain why the Cox model is sometimes described as ***semi-parametric***.

(Exercise 3 to follow)
---


#### Exercise 1

The Cox proportional hazards model is a widely used statistical model for analyzing survival data. It models the hazard function, which is the instantaneous risk of an event (such as death or failure) at a specific time, given that the event has not yet occurred.

The equation of the Cox proportional hazards model is:

```
h(t | z) = h_0(t) * exp(β^T z)
```

where:

* `h(t | z)` is the hazard function at time `t` for an individual with covariate vector `z`.
* `h_0(t)` is the baseline hazard function, which is the hazard function for an individual with all covariates equal to zero.
* `β` is a vector of regression coefficients that quantify the effect of the covariates on the hazard function.
* `z` is a vector of covariates.

The Cox model assumes that the hazard ratio, which is the ratio of the hazard functions for two individuals with different covariate vectors, is constant over time. This is known as the ***proportional hazards assumption***.

---

#### Exercise 2

The Cox model is sometimes described as **semi-parametric** because it makes parametric assumptions about the relationship between the covariates and the hazard function (through the regression coefficients), but it makes no parametric assumptions about the baseline hazard function. This flexibility in modeling the baseline hazard function makes the Cox model a powerful tool for analyzing survival data.

---

#### Exercise 3

* A Cox proportional hazards model was estimated to assess the effect on survival of a
person's sex and their self-esteem (measured on a three-point scale as ***low***, ***medium*** or ***high*** ). 

* The baseline category was males with low self-esteem.

* Write down the equation of the model, using algebraic symbols to represent variables
and parameters and defining all the symbols that you use.

---

#### Categorical Variables

* ***Sex***: 2 levels (i.e. male or female, with male as baseline)

* ***Self Esteem***: 3 levels (i.e. low, medium or high, with low as baseline)

* These variables are specified in the model using binary variables for the non-baseline levels.
---

The Cox proportional hazards model for this scenario can be written as:

```
h(t|sex,slf_estm) = h_0(t) exp(β_1 sex_f + β_2 slf_estm_M + β_3 slf_estm_H)
```

where:

* `h(t | sex, slf_estm)` is the hazard function at time `t` for an individual with given `sex` and `slf_estm`.

* `h_0(t)` is the baseline hazard function (for males with low self-esteem).

* `β_1`, `β_2`, and `β_3` are the regression coefficients for `sex` and the different levels of `slf_estm`.

* `sex_f` is a binary indicator variable equal to 1 if the individual is female and 0 otherwise.

* `slf_estm_M` and `slf_estm_H` are binary indicator variables equal to 1 if the individual's self-esteem is medium or high, respectively, and 0 otherwise.

---

* This equation models the hazard function as a multiplicative function of the baseline hazard and the exponentiated linear combination of the covariates. 

* The coefficients `β_1`, `β_2`, and `β_3` quantify the effect of `sex` and `slf_estm` on the hazard function, relative to the baseline group of males with low self-esteem.

---


---